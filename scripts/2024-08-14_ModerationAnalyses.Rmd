---
title: "2024-08-14_Moderation_Analyses"
author: "Celina Liane Müller"
date: "`r Sys.Date()`"
output: html_document
---

---
title: "2024-08-14_Hypothesis1_MultilevelModel"
date: "`r Sys.Date()`"
output: 
  html_document: 
    theme: cosmo
    toc: yes
    toc_float: yes
---

**Attentional Biases in OCD**  
**Script Part II / ?**  
**Date: 24.07.2024**  
**Version: Version 2**  

# Description
This is the main analysis file of hypothesis 3 and 4 of the 044_EYE project on Attentional Biases in OCD. This script includes the moderation analses and the correlation analysis to answer the question to potential moderating effects of stress and attentional control. 

### 3.) Attentional Control
#### Subjective Measure
**a.**	
In patients with **OCD** and patients with **spider phobia**, there will be a **positive association** between **vigilance bias** and **attentional control** as measured by the self-report questionnaire (Attentional Control Scale). This means the lower the attentional control, the faster patients with OCD or spider phobia will look at OCD-relevant or spider-relevant material, respectively, compared to negative or neutral material.
**b.**	
In patients with **OCD**, there will be a **negative association** between the **maintenance bias** and **attentional control** as measured by the self-report questionnaire (Attentional Control Scale). This means the lower the attentional control, the longer patients will look at idiosyncratic OCD-relevant material compared to negative or neutral material.

####Objective Measure
**c.**
In patients with **OCD** and patients with **spider phobia**, there will be a positive association between **vigilance bias** and **attentional control** as measured by the objective measure (AX-CPT).
**d.**
In patients with **OCD**, there will be a **negative association** between the **maintenance bias** and **attentional control** as measured by the objective measure (AX-CPT).

### 4.) Stress 
The induction of **stress** significantly increases the **maintenance bias** in patients with **OCD** (state-level). This means that patients with OCD will **look at OCD-relevant material for longer** after the stress induction than before the stress induction.

**Install Packages**
```{r install packages, message=F, warning=F, include=F}
# install.packages("ROCR")
# install.packages("lavaan")
# install.packages("psych")               # for basic calculations
# install.packages("foreign")             # xxx
# install.packages("ggplot2")             # for figures
# install.packages("car")                 # xxx
# install.packages("corpcor")             # for correlations
# install.packages("Hmisc")               # xxx
# install.packages("polycor")             # xxx
# install.packages("apaTables")           # for exporting tables according to APA style
# install.packages("QuantPsyc")           # xxx
# install.packages("effsize")             # xxx
# install.packages("tidyverse")           # for transforming data
# install.packages("readxl")              # for loading and exporting datasets
# install.packages("writexl")             # for loading and exporting datasets
# install.packages("bannerCommenter")     # for section headers
# install.packages("reshape2")            # for reshaping datasets
# install.packages("responsePatterns")    # for check of response patterns
# install.packages("corrplot")            # for correlation tables
# install.packages("gsubfn")              # for subsetting strings
# install.packages("data.table")          # for creating data tables
# install.packages("RColorBrewer")        # for colours in plots
# install.packages("pals")                # for colours in plots
# install.packages("devtools")
# install.packages("usethis")
# install.packages("lavaan")              # required to run SEMs
# install.packages("lavModel")            # required to run SEMs
# install.packages("ROCR")                # required to create ROC curves
# install.packages("hdf5r")
# install.packages("edfReader")           # required to read edf files
# install.packages("githubinstall")       # required to install packages from github
# install.packages("eyelinker")           # eyelink specific package
# install_github("alexander-pastukhov/eyelinkReader")                 # eyelink specific package
# install_github("aleksandernitka/EyeTracking_Tobii_VAS_IOHUB")  # eyelink specific package
# install.packages("gaze_analysis.R")     # for gaze analyses
# install.packages("report")              # to report results of anova
# install.packages("gazeR")                 # to preprocess eyetracking data
# install.packages("janitor")
# install.packages("multcomp")            # for multiple comparisons
# install.packages("lmerTest")            # for post-hoc tests of LMMs
# install.packages("JuliaCall")           # for coding in julia
# install.packages("sjPlot")              # for creating tables on LMM output
```

**Load Packages**
```{r load packages, message=F, warning=F, include=F}
library("ROCR")
library("lavaan")
library("psych")
library("foreign")
library("ggplot2")
library("car")
library("corpcor")
library("Hmisc")
library("polycor")
library("apaTables")
library("QuantPsyc")
library("effsize")
library("tidyverse")
library("readxl")
library("writexl")
library("bannerCommenter")
library("reshape2")
library("responsePatterns")
library("corrplot") 
library("gsubfn")
library("purrr")
library("data.table")
library("RColorBrewer")
library("pals")
library("dplyr")
library("edfReader")
library("devtools")
library("usethis")
library("lavaan")
library("ROCR")
library("githubinstall")
library("hdf5r")
# library("eyelinkReader")
library("stats")
library("ggplot2")
library("tidyr")
library("report")
# library("gazer")
library("janitor")
library("lme4")
library("multcomp")
library("lmerTest")
library("JuliaCall")
library("sjPlot")
```

**Define the Colour Scheme**
```{r colour scheme, message=F, warning=F, include=F}
color1 <- "#003C6799"
color2 <- "#CD534C99"
color3 <- 'lightgoldenrod1'
color4 <- "darkseagreen"
```

# Load Data 
```{r load data}
# data_dwelltime = read.csv("../data/data_dwelltime_OA.csv")
# data_entrytime = read.csv("../data/data_entrytime_OA.csv")
data_dwelltime = read.csv("/Volumes/109-psy-kp-study/044_EYE/05_Analyses/02_Main Project/01_Scripts/00_Github/project-ocd/data/2024-08-13_data_dwelltime_OA.csv")
data_entrytime = read.csv("/Volumes/109-psy-kp-study/044_EYE/05_Analyses/02_Main Project/01_Scripts/00_Github/project-ocd/data/2024-08-13_data_entrytime_OA.csv")
```


# Attentional Control 
## Objective Attentional Control - AX-CPT
The AX-CPT is a task where a sequence of letters ar presented to the participant. Each letter is presented one-at-a-time on the computer screen and the participant is asked to respond via button press. Target ("AX") trials are defined as an "A" that is followed by a "X". These trials occurred 70% of the time. Non-target trials are composed of "BX" trials, where the non-target cue (non-A) is followed by a target probe ("X"), "BY" trials, where the non-target cue (non-A) is followed by a non-target probe (non-X), and "AY" trials, where the valid cue ("A") is followed by a non-target probe (non-X). Each of these non-target trials occurs 10% of the time. The AX-CPT can assess proactive and reactive control.
**Proactive Control**
Proactive control can be assessed by examining performance on the BX trials. 
The presence of the non-target "B" cue demands that the participant must actively maintain the goal of making the non-dominant response (i.e., press "non AX") even in the presence of the target probe "X". Thereby, the participants needs to overwrite the response tendency elicited by the target probe "X" on this trial. 

**Reactive Control**
Reactive control can be assessed by performance on the AY trials. 
As AX trials occur with a high frequency (70%), the presence of the target cue "A" on a trial potentiates the already dom nant tendency to make the “target” ("X") response on this trial. Therefore, participants must react to the unexpected presentation of a Y stimulus on trial n by overriding the dominant response tendency (press "AX") to make the less-dominant "non-target" response (press "not AX").

### Comparisons AX-CPT Between Groups 
#### Error Rates
```{r differences between AX-CPT error rates}

```

#### Reaction Times 
```{r differences between AX-CPT reaction times}

```

## Subjective Attentional Control - ACS
The ACS is a self-report questionnaire assessing the ...

### Comparisons ACS Between Groups 
```{r differences between AX-CPT error rates}

```

# Stress
Participants of this study were randomised to received a stress reduction either at T1 or T2. Stress was induced by means of the cold-pressor test, which was shown to successfully increase levels of stress across a range of populations, incl. patients with OCD, spider phobia and healthy controls. This measure was assumed to be relatively unspecific to any psychological disorder. 

```{r}

```

